<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
 <title>Text to Audio</title>
 <!-- midi.js css -->
 <link href="/css/MIDIPlayer.css" rel="stylesheet" type="text/css" />
 <!-- midi.js package -->
 <script src="/js/Color/SpaceW3.js" type="text/javascript"></script>
 <script src="/js/MIDI/AudioDetect.js" type="text/javascript"></script>
 <script src="/js/MIDI/LoadPlugin.js" type="text/javascript"></script>
 <script src="/js/MIDI/Plugin.js" type="text/javascript"></script>
 <script src="/js/MIDI/Player.js" type="text/javascript"></script>
 <script src="/js/MusicTheory/Synesthesia.js" type="text/javascript"></script>
 <script src="/js/Widgets/Loader.js" type="text/javascript"></script>
 <script src="/js/Window/Event.js" type="text/javascript"></script>
 <script src="/js/Window/DOMLoader.XMLHttp.js" type="text/javascript"></script>
 <script src="/js/Window/DOMLoader.script.js" type="text/javascript"></script>
 <!-- jasmid package -->
 <script src="/js/jasmid/stream.js"></script>
 <script src="/js/jasmid/midifile.js"></script>
 <script src="/js/jasmid/replayer.js"></script>
 <!-- extras -->
 <script src="/js/Base64.js" type="text/javascript"></script>
 <script src="/js/base64binary.js" type="text/javascript"></script>
 <script src="/js/jquery-1.7.1-min.js" type="text/javascript"></script>

</head>
<body>
<h1>Text to Audio</h1>
<div style="position: fixed; top: 0; left: 0; z-index: 4; border-radius: 5px; overflow: hidden;" id="colors"></div><div style="text-align: center; border-radius: 5px; position: absolute; top: -70px; left: -40px; opacity: 0.9" id="colors"></div>
<div style="margin-bottom: 50px; border: 1px solid #000; background: rgba(255,255,255,0.5); border-radius: 10px; float: left; width: 800px;  position: relative; z-index: 2;">
 <div class="player" style="height: 42px; box-shadow: 0 -1px #000; margin-bottom: 0; border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
  <div style="margin: 0 auto; width: 160px; float: right;">
  <input type="image" src="./images/pause.png" align="absmiddle" value="pause" onclick="pausePlayStop()" id="pausePlayStop">
  <input type="image" src="./images/stop.png" align="absmiddle" value="stop" onclick="pausePlayStop(true)">
  <input type="image" src="./images/backward.png" align="absmiddle" value="stop" onclick="player.getNextSong(-1);">
  <input type="image" src="./images/forward.png" align="absmiddle" value="stop" onclick="player.getNextSong(+1);">
  </div>
  <div class="time-controls" style="float: left; margin: 0; position: relative; top: 5px;">
   <span id="time1" class="time">0:00</span>
   <span id="capsule">
	<span id="cursor"></span>
   </span>
   <span id="time2" class="time" style="text-align: left;">-0:00</span>
  </div>
 </div>
 <div id="textForm" style="position: relative;color: #000; z-index: -1;padding: 5px 11px 5px;">
     <p>Enter text to convert: </p>
     <form method="POST" action="javascript:submitForm();">
         <textarea rows="30" cols="80" id="textToConvert" name="textToConvert" value=""></textarea>
         <center><input type="submit" id="submit" name="convertText" value="hit me with your rhythm click" class="bigbutton"/></center>
     </form>
     <div style="margin-top: 20px; line-height: 1em;">
        <a href="javascript:selectPoem(0);">The Lady of Shallot - Tennyson</a><br/>
        <a href="javascript:selectPoem(1);">The charge of the light brigade - Tennyson</a><br/>
        <a href="javascript:selectPoem(2);">The Duet - Ella Wheeler Whilcox</a><br/>
        <a href="javascript:selectPoem(3);">Afternoon service in mellstock - Thomas Hardy</a><br/>
        <a href="javascript:selectPoem(4);">Howl - Allen Ginsberg</a><br/>
    </div>
 </div>
<script type="text/javascript">


if (typeof(console) === "undefined") var console = { log: function() { } };

// Begin loading indication.
var player;

// MIDI files from Disklavier World
var songid = 0;
var song = [
];

function submitForm(){
    var textToConvert = $('#textToConvert').val();
    $.ajax({
        type: "POST",
        url: "/texttomidi",
        contentType: "application/json",
        data: JSON.stringify({textToConvert: textToConvert})
    }).done(function(data){
            song[0] = data.midibase64;
            player.loadFile(song[0], player.start)
            }).fail(function(){
                alert("oops");
            });
}


var poems = [
        "Part I.\n\nOn either side the river lie\nLong fields of barley and of rye,\nThat clothe the wold and meet the sky;\nAnd thro' the field the road runs by\nTo many-tower'd Camelot;\nAnd up and down the people go,\nGazing where the lilies blow\nRound an island there below,\nThe island of Shalott.\n\nWillows whiten, aspens quiver,\nLittle breezes dusk and shiver\nThro' the wave that runs for ever\nBy the island in the river\nFlowing down to Camelot.\nFour gray walls, and four gray towers,\nOverlook a space of flowers,\nAnd the silent isle imbowers\nThe Lady of Shalott.\n\nBy the margin, willow-veil'd\nSlide the heavy barges trail'd\nBy slow horses; and unhail'd\nThe shallop flitteth silken-sail'd\nSkimming down to Camelot:\nBut who hath seen her wave her hand?\nOr at the casement seen her stand?\nOr is she known in all the land,\nThe Lady of Shalott?\n\nOnly reapers, reaping early\nIn among the bearded barley,\nHear a song that echoes cheerly\nFrom the river winding clearly,\nDown to tower'd Camelot:\nAnd by the moon the reaper weary,\nPiling sheaves in uplands airy,\nListening, whispers \"'Tis the fairy\nLady of Shalott.\"\n\nPart II.\n\nThere she weaves by night and day\nA magic web with colours gay.\nShe has heard a whisper say,\nA curse is on her if she stay\nTo look down to Camelot.\nShe knows not what the curse may be,\nAnd so she weaveth steadily,\nAnd little other care hath she,\nThe Lady of Shalott.\n\nAnd moving thro' a mirror clear\nThat hangs before her all the year,\nShadows of the world appear.\nThere she sees the highway near\nWinding down to Camelot:\nThere the river eddy whirls,\nAnd there the surly village-churls,\nAnd the red cloaks of market girls,\nPass onward from Shalott.\n\nSometimes a troop of damsels glad,\nAn abbot on an ambling pad,\nSometimes a curly shepherd-lad,\nOr long-hair'd page in crimson clad,\nGoes by to tower'd Camelot;\nAnd sometimes thro' the mirror blue\nThe knights come riding two and two:\nShe hath no loyal knight and true,\nThe Lady of Shalott.\n\nBut in her web she still delights\nTo weave the mirror's magic sights,\nFor often thro' the silent nights\nA funeral, with plumes and lights\nAnd music, went to Camelot:\nOr when the moon was overhead,\nCame two young lovers lately wed;\n\"I am half-sick of shadows,\" said\nThe Lady of Shalott.\n\nPart III.\n\nA bow-shot from her bower-eaves,\nHe rode between the barley-sheaves,\nThe sun came dazzling thro' the leaves,\nAnd flamed upon the brazen greaves\nOf bold Sir Lancelot.\nA redcross knight for ever kneel'd\nTo a lady in his shield,\nThat sparkled on the yellow field,\nBeside remote Shalott.\n\nThe gemmy bridle glitter'd free,\nLike to some branch of stars we see\nHung in the golden Galaxy.\nThe bridle-bells rang merrily\nAs he rode down to Camelot:\nAnd from his blazon'd baldric slung\nA mighty silver bugle hung,\nAnd as he rode his armour rung,\nBeside remote Shalott.\n\nAll in the blue unclouded weather\nThick-jewell'd shone the saddle-leather,\nThe helmet and the helmet-feather\nBurn'd like one burning flame together,\nAs he rode down to Camelot.\nAs often thro' the purple night,\nBelow the starry clusters bright,\nSome bearded meteor, trailing light,\nMoves over still Shalott.\n\nHis broad clear brow in sunlight glow'd;\nOn burnish'd hooves his war-horse trode;\nFrom underneath his helmet flow'd\nHis coal-black curls as on he rode,\nAs he rode down to Camelot.\nFrom the bank and from the river\nHe flash'd into the crystal mirror,\n\"Tirra lirra,\" by the river\nSang Sir Lancelot.\n\nShe left the web, she left the loom,\nShe made three paces thro' the room,\nShe saw the water-lily bloom,\nShe saw the helmet and the plume,\nShe look'd down to Camelot.\nOut flew the web and floated wide;\nThe mirror crack'd from side to side;\n\"The curse is come upon me,\" cried\nThe Lady of Shalott.\n\nPart IV.\n\nIn the stormy east-wind straining,\nThe pale-yellow woods were waning,\nThe broad stream in his banks complaining,\nHeavily the low sky raining\nOver tower'd Camelot;\nDown she came and found a boat\nBeneath a willow left afloat,\nAnd round about the prow she wrote\nThe Lady of Shalott.\n\nAnd down the river's dim expanse--\nLike some bold seÃ«r in a trance,\nSeeing all his own mischance--\nWith a glassy countenance\nDid she look to Camelot.\nAnd at the closing of the day\nShe loosed the chain, and down she lay;\nThe broad stream bore her far away,\nThe Lady of Shalott.\n\nLying, robed in snowy white\nThat loosely flew to left and right--\nThe leaves upon her falling light--\nThro' the noises of the night\nShe floated down to Camelot:\nAnd as the boat-head wound along\nThe willowy hills and fields among,\nThey heard her singing her last song,\nThe Lady of Shalott.\n\nHeard a carol, mournful, holy,\nChanted loudly, chanted lowly,\nTill her blood was frozen slowly,\nAnd her eyes were darken'd wholly,\nTurn'd to tower'd Camelot;\nFor ere she reach'd upon the tide\nThe first house by the water-side,\nSinging in her song she died,\nThe Lady of Shalott.\n\nUnder tower and balcony,\nBy garden-wall and gallery,\nA gleaming shape she floated by,\nA corse between the houses high,\nSilent into Camelot.\nOut upon the wharfs they came,\nKnight and burgher, lord and dame,\nAnd round the prow they read her name,\nThe Lady of Shalott.\n\nWho is this? and what is here?\nAnd in the lighted palace near\nDied the sound of royal cheer;\nAnd they cross'd themselves for fear,\nAll the knights at Camelot:\nBut Lancelot mused a little space;\nHe said, \"She has a lovely face;\nGod in his mercy lend her grace,\nThe Lady of Shalott.\"\"\n",
        "Half a league, half a league,\nâ Half a league onward,\nAll in the valley of Death,\nâ Rode the six hundred.\n'Forward, the Light Brigade!\nCharge for the guns' he said:\nInto the valley of Death\nâ Rode the six hundred.\n\n'Forward, the Light Brigade!'\nWas there a man dismay'd?\nNot tho' the soldiers knew\nâ Some one had blunder'd:\nTheirs not to make reply,\nTheirs not to reason why,\nTheirs but to do and die:\nInto the valley of Death\nâ Rode the six hundred.\n\nCannon to right of them,\nCannon to left of them,\nCannon in front of them\nâ Volley'd and thunder'd;\nStorm'd at with shot and shell,\nBoldly they rode and well,\nInto the jaws of Death,\nInto the mouth of Hell\nâ Rode the six hundred.\n\nFlash'd all their sabres bare,\nFlash'd as they turned in air\nSabring the gunners there,\nCharging an army while\nâ All the world wonder'd:\nPlunged in the battery-smoke\nRight thro' the line they broke;\nCossack and Russian\nReel'd from the sabre-stroke\nShatter'd and sunder'd.\nThen they rode back, but not\nNot the six hundred.\n\nCannon to right of them,\nCannon to left of them,\nCannon behind them\nâ Volley'd and thunder'd;\nStorm'd at with shot and shell,\nWhile horse and hero fell,\nThey that had fought so well\nCame thro' the jaws of Death,\nBack from the mouth of Hell,\nAll that was left of them,\nâ Left of six hundred.\n\nWhen can their glory fade?\nO the wild charge they made!\nâ All the world wonder'd.\nHonour the charge they made!\nHonour the Light Brigade,\nâ Noble six hundred!\n",
        "I was smoking a cigarette;\nMaud, my wife, and the tenor, McKey,\nWere singing together a blithe duet,\nAnd days it were better I should forget\nCame suddenly back to me,â\nDays when life seemed a gay masque ball,\nAnd to love and be loved was the sum of it all.\n\nAs they sang together, the whole scene fled,\nThe room's rich hangings, the sweet home air,\nStately Maud, with her proud blond head,\nAnd I seemed to see in her place instead\nA wealth of blue-black hair,\nAnd a face, ah! your faceâyours, Lisette;\nA face it were wiser I should forget.\n\nWe were backâwell, no matter when or where;\nBut you remember, I know, Lisette.\nI saw you, dainty and debonair,\nWith the very same look that you used to wear\nIn the days I should forget.\nAnd your lips, as red as the vintage we quaffed,\nWere pearl-edged bumpers of wine when you laughed.\n\nTwo small slippers with big rosettes\nPeeped out under your kilt-skirt there,\nWhile we sat smoking our cigarettes\n(Oh, I shall be dust when my heart forgets!)\nAnd singing that self-same air:\nAnd between the verses, for interlude,\nI kissed your throat and your shoulders nude.\n\nYou were so full of a subtle fire,\nYou were so warm and so sweet, Lisette;\nYou were everything men admire;\nAnd there were no fetters to make us tire,\nFor you wereâa pretty grisette.\nBut you loved as only such natures can,\nWith a love that makes heaven or hell for a man.\n\n\nThey have ceased singing that old duet,\nStately Maud and the tenor, McKey.\n\"You are burning your coat with your cigarette,\nAnd qu'avez vous, dearest, your lids are wet,\"\nMaud says, as she leans o'er me.\nAnd I smile, and lie to her, husband-wise,\n\"Oh, it is nothing but smoke in my eyes.\"",
        "On afternoons of drowsy calm\nWe stood in the panelled pew,\nSinging one-voiced a Tate-and-Brady psalm\nTo the tune of 'Cambridge New'.\n\nWe watched the elms, we watched the rooks,\nThe clouds upon the breeze,\nBetween the whiles of glancing at our books,\nAnd swaying like the trees.\n\nSo mindless were those outpourings!\nThough I am not aware\nThat I have gained by subtle thought on things\nSince we stood psalming there.\n",
        "I saw the best minds of my generation destroyed by madness, starving\n  hysterical naked,\ndragging themselves through the negro streets at dawn looking for an angry\n  fix,\nangelheaded hipsters burning for the ancient heavenly connection to the \n  starry dynamo in the machinery of night,\nwho poverty and tatters and hollow-eyed and high sat up smoking in the\n  supernatural darkness of cold-water flats floating across the tops of\n  cities contemplating jazz,\nwho bared their brains to Heaven under the El and saw Mohammedan angels\n  staggering on tenement roofs illuminated,\nwho passed through universities with radiant cool eyes hallucinating Arkan-\n  sas and Blake-light tragedy among the scholars of war,\nwho were expelled from the academies for crazy & publishing obscene odes\n  on the windows of the skull,\nwho cowered in unshaven rooms in underwear, burning their money in\n  wastebaskets and listening to the Terror through the wall,\nwho got busted in their pubic beards returning through Laredo with a belt \n  of marijuana for New York,\nwho ate fire in paint hotels or drank turpentine in Paradise Alley, death, or\n  purgatoried their torsos night after night\nwith dreams, with drugs, with waking nightmares, alcohol and cock and \n  endless balls,\nincomparable blind streets of shuddering cloud and lightning in the mind\n  leaping toward poles of Canada & Paterson, illuminating all the mo-\n  tionless world of Time between,\nPeyote solidities of halls, backyard green tree cemetery dawns, wine drunk-\n  enness over the rooftops, storefront boroughs of teahead joyride neon\n  blinking traffic light, sun and moon and tree vibrations in the roaring\n  winter dusks of Brooklyn, ashcan rantings and kind king light of\n  mind,\nwho chained themselves to subways for the endless ride from Battery to holy\n  Bronx on benzedrine until the noise of wheels and children brought \n  them down shuddering mouth-wracked and battered bleak of brain\n  all drained of brilliance in the drear light of Zoo,\nwho sank all night in submarine light of Bickford's floated out and sat\n  through the stale beer afternoon in desolate Fugazzi's, listening to the\n  crack of doom on the hydrogen jukebox, \nwho talked continuously seventy hours from park to pad to bar to Bellevue\n  to museum to the Brooklyn Bridge,\na lost battalion of platonic conversationalists jumping down the stoops off fire\n  escapes off windowsills of Empire State out of the moon,\nyacketayakking screaming vomiting whispering facts and memories and\n  anecdotes and eyeball kicks and shocks of hospitals and jails and wars,\nwhole intellects disgorged in total recall for seven days and nights with\n  brilliant eyes, meat for the Synagogue cast on the pavement,\nwho vanished into nowhere Zen New Jersey leaving a trail of ambiguous\n  picture postcards of Atlantic City Hall,\nsuffering Eastern sweats and Tangerian bone-grindings and migraines of\n  China under junk-withdrawal in Newark's bleak furnished room,\nwho wandered around and around at midnight in the railroad yard wonder-\n  ing where to go, and went, leaving no broken hearts,\nwho lit cigarettes in boxcars boxcars boxcars racketing through snow toward\n  lonesome farms in grandfather night,\nwho studied Plotinus Poe St. John of the Cross telepathy and bop kabbalah\n  because the cosmos instinctively vibrated at their feet in Kansas,\nwho loned it through the streets of Idaho seeking visionary indian angels\n  who were visionary indian angels,\nwho thought they were only mad when Baltimore gleamed in supernatural \n  ecstasy,\nwho jumped in limousines with the Chinaman of Oklahoma on the impulse \n  of winter midnight streetlight smalltown rain,\nwho lounged hungry and lonesome through Houston seeking jazz or sex or\n  soup, and followed the brilliant Spaniard to converse about America\n  and Eternity, a hopeless task, and so took ship to Africa,\nwho disappeared into the volcanoes of Mexico leaving behind nothing but\n  the shadow of dungarees and the lava and ash of poetry scattered in\n  fireplace Chicago,\nwho reappeared on the West Coast investigating the FBI in beards and shorts\n  with big pacifist eyes sexy in their dark skin passing out incompre-\n  hensible leaflets,\nwho burned cigarette holes in their arms protesting the narcotic tobacco haze \n  of Capitalism,\nwho distributed Supercommunist pamphlets in Union Square weeping and \n  undressing while the sirens of Los Alamos wailed them down, and\n  wailed down Wall, and the Staten Island ferry also wailed,\nwho broke down crying in white gymnasiums naked and trembling before \n  the machinery of other skeletons,\nwho bit detectives in the neck and shrieked with delight in policecars for \n  committing no crime but their own wild cooking pederasty and \n  intoxication,\nwho howled on their knees in the subway and were dragged off the roof\n  waving genitals and manuscripts,\nwho let themselves be fucked in the ass by saintly motorcyclists, and\n  screamed with joy,\nwho blew and were blown by those human seraphim, the sailors, caresses of\n  Atlantic and Caribbean love,\nwho balled in the morning in the evenings in rosegardens and the grass of\n  public parks and cemeteries scattering their semen freely to whom-\n  ever come who may,\nwho hiccuped endlessly trying to giggle but wound up with a sob behind\n  a partition in a Turkish Bath when the blond & naked angel came to \n  pierce them with a sword,\nwho lost their loveboys to the three old shrews of fate the one eyed shrew\n  of the heterosexual dollar the one eyed shrew that winks out of the\n  womb and the one eyed shrew that does nothing but sit on her ass\n  and snip the intellectual golden threads of the craftsman's loom.\nwho copulated ecstatic and insatiate with a bottle of beer a sweetheart a\n  package of cigarettes a candle and fell off the bed, and continued\n  along the floor and down the hall and ended fainting on the wall with\n  a vision of ultimate cunt and come eluding the last gyzym of con-\n  sciousness,\nwho sweetened the snatches of a million girls trembling in the sunset, and\n  were red eyed in the morning but prepared to sweeten the snatch of\n  the sunrise, flashing buttocks under barns and naked in the lake,\nwho went out whoring through Colorado in myriad stolen night-cars, N.C.,\n  secret hero of these poems, cocksman and Adonis of Denver--joy to\n  the memory of his innumerable lays of girls in empty lots & diner\n  backyards, moviehouses' rickety rows, on mountaintops in caves or\n  with gaunt waitresses in familiar roadside lonely petticoat upliftings\n  & especially secret gas-station solipsisms of johns, & hometown alleys\n  too,\nwho faded out in vast sordid movies, were shifted in dreams, woke on a \n  sudden Manhattan, and picked themselves up out of basements hung-\n  over with heartless Tokay and horrors of Third Avenue iron dreams\n  & stumbled to unemployment offices,\nwho walked all night with their shoes full of blood on the snowbank docks\n  waiting for a door in the East River to open to a room full of steam-\n  heat and opium,\nwho created great suicidal dramas on the apartment cliff-banks of the Hud-\n  son under the wartime blue floodlight of the moon & their heads shall \n  be crowned with laurel in oblivion,\nwho ate the lamb stew of the imagination or digested the crab at the muddy \n  bottom of the rivers of Bowery,\nwho wept at the romance of the streets with their pushcarts full of onions\n  and bad music,\nwho sat in boxes breathing in the darkness under the bridge, and rose up to\n  build harpsichords in their lofts,\n\nwho coughed on the sixth floor of Harlem crowned with flame under the\n  tubercular sky surrounded by orange crates of theology,\nwho scribbled all night rocking and rolling over lofty incantations which in\n  the yellow morning were stanzas of gibberish,\nwho cooked rotten animals lung heart feet tail borsht & tortillas dreaming\n  of the pure vegetable kingdom,\nwho plunged themselves under meat trucks looking for an egg,\nwho threw their watches off the roof to cast their ballot for Eternity outside \n  of Time, & alarm clocks fell on their heads every day for the next \n  decade,\nwho cut their wrists three times successively unsuccessfully, gave up and\n  were forced to open antique stores where they thought they were \n  growing old and cried,\nwho were burned alive in their innocent flannel suits on Madison Avenue\n  amid blasts of leaden verse & the tanked-up clatter of the iron regi-\n  ments of fashion & the nitroglycerine shrieks of the fairies of advertis-\n  ing & the mustard gas of sinister intelligent editors, or were run down\n  by the drunken taxicabs of Absolute Reality,\nwho jumped off the Brooklyn Bridge this actually happened and walked \n  away unknown and forgotten into the ghostly daze of Chinatown\n  soup alleyways & firetrucks, not even one free beer,\nwho sang out of their windows in despair, fell out of the subway window,\n  jumped in the filthy Passaic, leaped on negroes, cried all over the \n  street, danced on broken wineglasses barefoot smashed phonograph\n  records of nostalgic European 1930s German jazz finished the whis-\n  key and threw up groaning into the bloody toilet, moans in their ears\n  and the blast of colossal steamwhistles,\nwho barreled down the highways of the past journeying to the each other's\n  hotrod-Golgotha jail-solitude watch or Birmingham jazz incarnation,\nwho drove crosscountry seventytwo hours to find out if I had a vision or you\n  had a vision or he had a vision to find out Eternity,\nwho journeyed to Denver, who died in Denver, who came back to Denver\n  & waited in vain, who watched over Denver & brooded & loned in\n  Denver and finally went away to find out the Time, & now Denver\n  is lonesome for her heroes,\nwho fell on their knees in hopeless cathedrals praying for each other's salva-\n  tion and light and breasts, until the soul illuminated its hair for a \n  second, \nwho crashed through their minds in jail waiting for impossible criminals \n  with golden heads and the charm of reality in their hearts who sang\n  sweet blues to Alcatraz,\nwho retired to Mexico to cultivate a habit, or Rocky Mount to tender Buddha\n  or Tangiers to boys or Southern Pacific to the black locomotive or \n  Harvard to Narcissus to Woodlawn to the daisychain or grave,\nwho demanded sanity trials accusing the radio of hypnotism & were left with\n  their insanity & their hands & a hung jury,\nwho threw potato salad at CCNY lecturers on Dadaism and subsequently\n  presented themselves on the granite steps of the madhouse with\n  shaven heads and harlequin speech of suicide, demanding instanta-\n  neous lobotomy,\nand who were given instead the concrete void of insulin Metrazol electricity\n  hydrotherapy psychotherapy occupational therapy pingpong & am-\n  nesia,\nwho in humorless protest overturned only one symbolic pingpong table,\n  resting briefly in catatonia,\nreturning years later truly bald except for a wig of blood, and tears and \n  fingers, to the visible madman doom of the wards of the madtowns \n  of the East,\nPilgrim State's Rockland's and Greystone's foetid halls, bickering with the\n  echoes of the soul, rocking and rolling in the midnight solitude-bench\n  dolmen-realms of love, dream of life a nightmare, bodies turned to \n  stone as heavy as the moon,\nwith mother finally ******, and the last fantastic book flung out of the \n  tenement window, and the last door closed at 4 a.m. and the last \n  telephone slammed at the wall in reply and the last furnished room \n  emptied down to the last piece of mental furniture, a yellow paper\n  rose twisted on a wire hanger in the closet, and even that imaginary,\n  nothing but a hopeful little bit of hallucination--\nah, Carl, while you are not safe I am not safe, and now you're really in the\n  total animal soup of time--\nand who therefore ran through the icy streets obsessed with a sudden flash \n  of the alchemy of the use of the ellipse the catalog the meter & the\n  vibrating plane,\nwho dreamt and made incarnate gaps in Time & Space through images\n  juxtaposed, and trapped the archangel of the soul between 2 visual\n  images and joined the elemental verbs and set the noun and dash of\n  consciousness together jumping with sensation of Pater Omnipotens\n  Aeterna Deus\nto recreate the syntax and measure of poor human prose and stand before\n  you speechless and intelligent and shaking with shame, rejected yet \n  confessing out the soul to conform to the rhythm of thought in his\n  naked and endless head,\nthe madman bum and angel beat in Time, unknown, yet putting down here\n  what might be left to say in time come after death,\nand rose reincarnate in the ghostly clothes of jazz in the goldhorn shadow\n  of the band and blew the suffering of America's naked mind for love\n  into an eli eli lamma lamma sabacthani saxophone cry that shivered\n  the cities down to the last radio\nwith the absolute heart of the poem of life butchered out of their own bodies \n  good to eat a thousand years.\n \n\nII\n\nWhat sphinx of cement and aluminum bashed open their skulls and ate up\n  their brains and imagination?\nMoloch! Solitude! Filth! Ugliness! Ashcans and unobtainable dollars! Chil-\n  dren screaming under the stairways! Boys sobbing in armies!  Old\n  men weeping in the parks!\nMoloch! Moloch! Nightmare of Moloch! Moloch the loveless! Mental Mo-\n  loch! Moloch the heavy judger of men!\nMoloch the incomprehensible prison! Moloch the crossbone soulless jail-\n  house and Congress of sorrows! Moloch whose buildings are judg-\n  ment! Moloch the vast stone of war! Moloch the stunned govern-\n  ments!\nMoloch whose mind is pure machinery! Moloch whose blood is running\n  money! Moloch whose fingers are ten armies! Moloch whose breast \n  is a cannibal dynamo!  Moloch whose ear is a smoking tomb!\nMoloch whose eyes are a thousand blind windows! Moloch whose skyscrap-\n  ers stand in the long streets like endless Jehovahs! Moloch whose\n  factories dream and croak in the fog! Moloch whose smokestacks and\n  antennae crown the cities!\nMoloch whose love is endless oil and stone! Moloch whose soul is electricity\n  and banks! Moloch whose poverty is the specter of genius! Moloch\n  whose fate is a cloud of sexless hydrogen! Moloch whose name is the\n  Mind!\nMoloch in whom I sit lonely! Moloch in whom I dream Angels! Crazy in\n  Moloch! Cocksucker in Moloch! Lacklove and manless in Moloch!\nMoloch who entered my soul early! Moloch in whom I am a consciousness\n  without a body! Moloch who frightened me out of my natural ec-\n  stasy! Moloch whom I abandon! Wake up in Moloch! Light stream-\n  ing out of the sky!\nMoloch! Moloch! Robot apartments! invisible suburbs! skeleton treasuries!\n  blind capitals! demonic industries! spectral nations! invincible mad houses\n  granite cocks! monstrous bombs! \nThey broke their backs lifting Moloch to Heaven! Pavements, trees, radios,\n  tons! lifting the city to Heaven which exists and is everywhere about us! \nVisions! omens! hallucinations! miracles! ecstasies! gone down the American\n  river! \nDreams! adorations! illuminations! religions! the whole boatload of sensitive\n  bullshit! \nBreakthroughs! over the river! flips and crucifixions! gone down the flood!\n  Highs! Epiphanies! Despairs! Ten years' animal screams and suicides!\n  Minds! New loves! Mad generation! down on the rocks of Time!\nReal holy laughter in the river! They saw it all! the wild eyes! the holy yells!\n  They bade farewell! They jumped off the roofl to solitude! waving! carrying\n  flowers! Down to the river! into the street!\n"

];

function selectPoem(index){
    $('#textToConvert').val(poems[index]);
}

// Toggle between Pause and Play modes.
var pausePlayStop = function(stop) {
	var d = document.getElementById("pausePlayStop");
	if (stop) {
		MIDI.Player.stop();
		d.src = "./images/play.png";
	} else if (MIDI.Player.playing) {
		d.src = "./images/play.png";
		MIDI.Player.pause(true);
	} else {
		d.src = "./images/pause.png";
		MIDI.Player.resume();
	}
};

Event.add(window, "load", function(event) {
	var link = document.createElement('link');
	link.href = 'http://fonts.googleapis.com/css?family=Oswald';
	link.ref = "stylesheet";
	link.type = "text/css";
	document.body.appendChild(link);
	var link = document.createElement('link');
	link.href = 'http://fonts.googleapis.com/css?family=Andada';
	link.ref = "stylesheet";
	link.type = "text/css";
	document.body.appendChild(link);
	// load up the piano keys
	var colors = document.getElementById("colors");
	var colorElements = [];
	for (var n = 0; n < 88; n ++) {
		var d = document.createElement("div");
		d.innerHTML = MIDI.noteToKey[n+21];
		colorElements.push(d);
		colors.appendChild(d);
	}
	//
	MIDI.loader = new widgets.Loader;
    MIDI.loadPlugin({
        soundfontUrl: "/soundfont/",
        instruments: ["acoustic_grand_piano", "synth_drum"],
        callback: function(){
            MIDI.programChange(0,0);
            MIDI.programChange(1,118);
            player = MIDI.Player;
            player.timeWarp = 1; // speed the song is played back
            //player.loadFile(song[0], player.start);
            // control the piano keys colors
            var colorMap = MusicTheory.Synesthesia.map();
            player.addListener(function(data) {
                var pianoKey = data.note - MIDI.pianoKeyOffset;
                var d = colorElements[pianoKey];
                if (data.message === 144) {
                    var map = colorMap[data.note - 27];
                    if (map) d.style.background = map.hex;
                    d.style.color = "#fff";
                } else {
                    d.style.background = "";
                    d.style.color = "";
                }
            });
            //
            //ColorSphereBackground();
            MIDIPlayerPercentage(player);
            //
            MIDI.loader.stop();
        }
    });
//	MIDI.loadPlugin(function () {
//		// this is the language we are running in
//		//var title = document.getElementById("title");
//		//title.innerHTML = "Sound being generated with " + MIDI.lang + ".";
//		// this sets up the MIDI.Player and gets things going...
//		player = MIDI.Player;
//		player.timeWarp = 1; // speed the song is played back
//		//player.loadFile(song[0], player.start);
//		// control the piano keys colors
//		var colorMap = MusicTheory.Synesthesia.map();
//		player.addListener(function(data) {
//			var pianoKey = data.note - MIDI.pianoKeyOffset;
//			var d = colorElements[pianoKey];
//			if (data.message === 144) {
//				var map = colorMap[data.note - 27];
//				if (map) d.style.background = map.hex;
//				d.style.color = "#fff";
//			} else {
//				d.style.background = "";
//				d.style.color = "";
//			}
//		});
//		//
//		//ColorSphereBackground();
//		MIDIPlayerPercentage(player);
//		//
//		MIDI.loader.stop();
//	});
});

///////  ///////

var MIDIPlayerPercentage = function(player) {
	// update the timestamp
	var time1 = document.getElementById("time1");
	var time2 = document.getElementById("time2");
	var capsule = document.getElementById("capsule");
	var timeCursor = document.getElementById("cursor");
	//
	Event.add(capsule, "drag", function (event, self) {
		Event.cancel(event);
		player.currentTime = (self.x) / 420 * player.endTime;
		if (player.currentTime < 0) player.currentTime = 0;
		if (player.currentTime > player.endTime) player.currentTime = player.endTime;
		if (self.state === "down") {
			player.pause(true);
		} else if (self.state === "up") {
			player.resume();
		}
	});
	//
	function timeFormatting(n) {
		var minutes = n / 60 >> 0; 
		var seconds = String(n - (minutes * 60) >> 0);
		if (seconds.length == 1) seconds = "0" + seconds;
		return minutes + ":" + seconds;
	};
	player.getNextSong = function(n) {
		var id = Math.abs((songid += n) % song.length);
		player.loadFile(song[id], player.start); // load MIDI
	};
	player.setAnimation(function(data, element) {
		var percent = data.now / data.end;
		var now = data.now >> 0; // where we are now
		var end = data.end >> 0; // end of song
		if (now === end) { // go to next song
			var id = ++ songid % song.length;
			player.loadFile(song[id], player.start); // load MIDI
		}
		// display the information to the user
		timeCursor.style.width = (percent * 100) + "%";
		time1.innerHTML = timeFormatting(now);
		time2.innerHTML = "-" + timeFormatting(end - now);
	});
};

/////// SPHERE ///////

var ColorSphereBackground = function() {
	var d = document;
	var canvas = document.createElement("canvas");
	var ctx = canvas.getContext("2d");
	canvas.style.cssText = "position: fixed; left: 0; top: 0; opacity: 1";
	canvas.style.width = window.innerWidth + "px";
	canvas.style.height = window.innerHeight + "px";
	document.body.appendChild(canvas);
	//
	Event.add(window, "resize", function() {
		canvas.style.width = window.innerWidth + "px";
		canvas.style.height = window.innerHeight + "px";
		ctx.drawImage(theSphere = sphere(percent), 0, 0)
	});
	Event.add(d, "scroll", function(e) {
		var percent = 1 - document.body.scrollTop / document.body.scrollHeight;
		ctx.drawImage(theSphere = sphere(percent), 0, 0);
		onMouseMove();
	});

	var theSphere;
	var px = window.innerWidth / 2;
	var py = window.innerHeight / 2;
	var onMouseMove = function(event) {
		ctx.drawImage(theSphere, 0, 0);
		if (event) {
			var coords = Event.proxy.getCoord(event);
			coords.x -= document.body.scrollLeft;
			coords.y -= document.body.scrollTop;
			px = coords.x;
			py = coords.y;
		} else { // 
			var coords = { x: px, y: py };
		}
		//
		var x = (coords.x / window.innerWidth) * 255 - 127; // grab mouse pixel coords, center at midpoint
		var y = (coords.y / window.innerHeight) * 255 - 127;
		var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height); // get image data
		var data = imageData.data;
		for(var n = 0, length = data.length; n < length; n += 4) {
			data[n] = data[n] + x - y; // red (control left)
			data[n + 1] = data[n + 1] - x - y; // green (control right)
			data[n + 2] = data[n + 2] + y + y; // blue (control down)
		}
		ctx.putImageData(imageData, 0, 0);
	};
	Event.add(d, "mousemove", onMouseMove);
	//
	function sphere(top) { // create Sphere image, and apply to <canvas>
		var canvas1 = document.createElement("canvas");
		var ctx = canvas1.getContext("2d");
		var w = 75;
		var left = -20;
		var top = top * -50;
		canvas.width = canvas1.width = w * window.innerWidth / window.innerHeight;
		canvas.height = canvas1.height = w;
		ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);
		n = 360; while(n--) { // go through hues
			var x = left + w;
			var y = top + w;
			var g = ctx.createLinearGradient(x, top, x, y);
			g.addColorStop(0, "#000");
			g.addColorStop(.5, "hsl("+((n + 60) % 360)+",100%,50%)");
			g.addColorStop(1, "#FFF");
			ctx.beginPath(); // draw triangle
			ctx.moveTo(x, top);
			ctx.lineTo(x, y);
			ctx.lineTo(x + 2, y);
			ctx.lineTo(x + 5, top);
			ctx.fillStyle = g; // apply gradient
			ctx.fill();
			ctx.translate(x, y); // rotate + translate into position
			ctx.rotate((1 / 360) * Math.PI * 2);
			ctx.translate(-x, -y);
		}
		return canvas1;
	};
	//
	var percent = 1 - document.body.scrollTop / document.body.scrollHeight;
	ctx.drawImage(theSphere = sphere(percent), 0, 0)
};


</script>
</body>
</html>